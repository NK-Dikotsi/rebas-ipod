<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>reba's ipod · video playlist · RK's Island</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
    }
    body {
      background: #f2f4f8;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Inter', sans-serif;
      gap: 24px;
    }
    .top-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }
    .online-badge {
      background-color: rgba(90, 238, 108, 0.1);
      border-radius: 2px;
      display: flex;
      place-content: center;
      align-items: center;
      gap: 4px;
      width: min-content;
      padding: 2px 8px;
      border: 0.5px solid rgba(90, 238, 108, 0.15);
    }
    .dot-container {
      position: relative;
      width: 14px;
      height: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .green-dot {
      width: 8px;
      height: 8px;
      background-color: rgb(90, 238, 108);
      border-radius: 50%;
      z-index: 2;
      box-shadow: 0 0 4px rgba(90, 238, 108, 0.4);
    }
    .glow-ring {
      aspect-ratio: 1;
      width: 8px;
      background-color: rgb(90, 238, 108);
      border-radius: 50%;
      opacity: 0.1;
      transform: translate(-50%, -50%) scale(2.0);
      position: absolute;
      top: 50%;
      left: 50%;
      animation: subtleGlow 3s infinite ease-in-out;
      pointer-events: none;
    }
    @keyframes subtleGlow {
      0% { opacity: 0.06; transform: translate(-50%, -50%) scale(1.8); }
      40% { opacity: 0.13; transform: translate(-50%, -50%) scale(2.2); }
      80% { opacity: 0.07; transform: translate(-50%, -50%) scale(1.9); }
      100% { opacity: 0.06; transform: translate(-50%, -50%) scale(1.8); }
    }
    .online-text {
      font-family: "IBM Plex Mono", monospace;
      font-size: 13px;
      font-weight: 500;
      color: rgb(90, 238, 108);
      white-space: nowrap;
    }
    .location-line {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 13px;
      color: #000000;
      padding: 2px 0;
    }
    .my-time-block {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: "IBM Plex Mono", monospace;
      color: #b1b1b1;
    }
    #liveTime { color: #000000; }
    .ampm-suffix { color: #000000; margin-left: 2px; }
    .property-title p {
      font-family: 'Inter', sans-serif;
      font-size: 15px;
      font-weight: 400;
      color: #000000;
      line-height: 1.6;
      text-align: center;
      max-width: 500px;
      padding: 0 20px;
      margin-top: 8px;
    }
    /* Red text styles: full word red, or only apostrophe+s */
    .property-title .red-text {
      color: #ff0000;
      position: relative;
      display: inline-block;
      font-weight: 500;
    }
    .property-title .red-text::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg,transparent 0%,rgba(255,255,255,0.6) 40%,rgba(255,255,255,0.9) 50%,rgba(255,255,255,0.6) 60%,transparent 100%);
      animation: shine 60s infinite ease-in-out;
      pointer-events: none;
    }
    /* for partial red (apostrophe s) */
    .red-apos {
      color: #ff0000;
      font-weight: 500;
    }
    @keyframes shine {
      0% { left: -100%; }
      3% { left: -100%; }
      8% { left: 100%; }
      100% { left: 100%; }
    }
    .ipod {
      width: 200px;
      height: 340px;
      background: linear-gradient(145deg, #fff, #f5f5f5);
      border-radius: 20px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      box-shadow: rgba(0,0,0,0.1) 0px 0px 0px 1px, rgba(0,0,0,0.1) 0px 2px 4px, rgba(0,0,0,0.15) 0px 8px 16px, rgba(0,0,0,0.2) 0px 16px 32px;
    }
    .screen {
      width: 100%;
      height: 140px;
      background: linear-gradient(rgb(160,168,160), rgb(184,192,184));
      border-radius: 8px;
      border: 1px solid rgb(153,153,153);
      overflow: hidden;
      position: relative;
      display: flex;
      flex-direction: column;
      transition: background 0.4s, filter 0.4s;
    }
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 8px 3px 8px;
      font-size: 9px;
      font-weight: 500;
      color: rgb(42,42,42);
      border-bottom: 1px solid rgb(110,118,110);
    }
    .time { flex:1; text-align:left; }
    .menu-location { flex:1; text-align:center; font-weight:500; text-transform:uppercase; font-size:9px; }
    .battery-container { flex:1; display:flex; justify-content:flex-end; }
    .battery-outline {
      width:19px; height:10px; border:1px solid rgb(74,74,74); border-radius:2px;
      display:flex; align-items:center; padding:1px; gap:1px;
    }
    .battery-block {
      flex:1; height:100%; background-color:rgb(74,74,74);
      animation: chargePulse 1.8s infinite;
    }
    .battery-block:nth-child(2) { animation-delay:0.2s; }
    .battery-block:nth-child(3) { animation-delay:0.4s; }
    .battery-block:nth-child(4) { animation-delay:0.6s; }
    @keyframes chargePulse {
      0% { background-color:rgb(180,180,180); }
      30% { background-color:rgb(74,74,74); }
      70% { background-color:rgb(74,74,74); }
      100% { background-color:rgb(180,180,180); }
    }
    /* scrollable containers */
    .menu-container, .video-list-container, .gifts-container, .settings-container, .diary-container {
      flex:1;
      background:transparent;
      overflow-y:scroll;
      scrollbar-width:thin;
      scrollbar-color:#4a4a4a transparent;
      position: relative;
      scroll-behavior: smooth;
    }
    .menu-container::-webkit-scrollbar, .video-list-container::-webkit-scrollbar,
    .gifts-container::-webkit-scrollbar, .settings-container::-webkit-scrollbar,
    .diary-container::-webkit-scrollbar { 
      width:4px; 
      display: block;
    }
    .menu-container::-webkit-scrollbar-track, .video-list-container::-webkit-scrollbar-track,
    .gifts-container::-webkit-scrollbar-track, .settings-container::-webkit-scrollbar-track,
    .diary-container::-webkit-scrollbar-track {
      background: transparent;
    }
    .menu-container::-webkit-scrollbar-thumb, .video-list-container::-webkit-scrollbar-thumb,
    .gifts-container::-webkit-scrollbar-thumb, .settings-container::-webkit-scrollbar-thumb,
    .diary-container::-webkit-scrollbar-thumb { 
      background:#4a4a4a; 
      border-radius:2px; 
    }
    .menu-item {
      padding:4px 8px;
      background:transparent;
      color:rgb(42,42,42);
      cursor:pointer;
      font-size:10px;
      font-weight:400;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .menu-item.active {
      background-color:rgb(74,74,74);
      color:rgb(208,216,208);
    }
    /* Diary message styling */
    .diary-message {
      padding: 10px 8px;
      font-family: 'Inter', sans-serif;
      font-size: 10px;
      line-height: 1.5;
      color: rgb(42,42,42);
      background: rgba(255,255,240,0.3);
      border-left: 2px solid rgb(74,74,74);
      margin: 5px;
      border-radius: 0 6px 6px 0;
      white-space: pre-wrap;
      word-break: break-word;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.05);
    }
    .diary-message p {
      margin-bottom: 6px;
    }
    .diary-message .signature {
      text-align: right;
      font-style: italic;
      margin-top: 8px;
      font-weight: 500;
    }
    .video-container {
      display:none;
      width:100%;
      flex: 1;
      background:#000;
      position: relative;
    }
    video {
      width:100%;
      height:100%;
      object-fit: contain;
      background: #000;
    }
    .splash-screen {
      position:absolute; top:0; left:0; right:0; bottom:0;
      background:linear-gradient(rgb(160,168,160), rgb(184,192,184));
      display:flex; flex-direction:column; justify-content:center; align-items:center; gap:6px;
      z-index:20;
    }
    .splash-screen.hidden { display:none; }
    .apple-png {
      width:38px; height:38px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%232a2a2a"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M15 3c.58-.69 1.04-1.64.93-2.6-.9.04-1.99.6-2.64 1.36-.58.69-1.08 1.63-.95 2.6 1.01.08 2.04-.52 2.66-1.36"/></svg>');
      background-size:contain; background-repeat:no-repeat; background-position:center;
    }
    .ipod-name { font-size:12px; font-weight:500; color:rgb(42,42,42); }
    .wheel {
      width:160px; height:160px; border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #f9f9f9, #dadada);
      align-self:center; position:relative; margin-top:5px;
      box-shadow:inset 0 2px 6px rgba(0,0,0,0.15), 0 6px 10px rgba(0,0,0,0.2);
    }
    .menu-btn {
      position:absolute; top:18px; left:50%; transform:translateX(-50%);
      font-size:10px; font-weight:600; color:rgb(60,60,60); background:transparent; border:none; cursor:pointer; z-index:10;
    }
    .next-btn, .prev-btn, .play-btn {
      position:absolute; background:transparent; border:none; cursor:pointer; z-index:10; padding:0;
    }
    .next-btn { top:50%; right:18px; transform:translateY(-50%); width:20px; height:20px; }
    .prev-btn { top:50%; left:18px; transform:translateY(-50%); width:20px; height:20px; }
    .play-btn { bottom:18px; left:50%; transform:translateX(-50%); width:26px; height:18px; }
    .next-btn svg, .prev-btn svg, .play-btn svg { width:100%; height:100%; display:block; }
    .center-btn {
      width:55px; height:55px; border-radius:50%;
      background:radial-gradient(circle at 35% 35%, #fff, #dddddd);
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      box-shadow:0 0 0 1px rgba(0,0,0,0.1), 0 3px 6px rgba(0,0,0,0.15);
      cursor:pointer; border:none; z-index:5;
    }
    .hidden { display:none !important; }
    .screen-content { flex:1; display:flex; flex-direction:column; position:relative; }
    .screen.blue-light { background:rgb(197,224,245) !important; border:1px solid rgb(10,54,103) !important; }
    /* video list tweaks */
    .video-list-container .menu-item {
      font-size:9px; padding:3px 8px;
    }
    .video-number {
      display: inline-block;
      min-width: 16px;
      margin-right: 4px;
      font-family: "IBM Plex Mono", monospace;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <!-- top section with red: Kutlwano, Reboane's (only 's red), Island -->
  <div class="top-section">
    <div class="online-badge">
      <div class="dot-container"><div class="green-dot"></div><div class="glow-ring"></div></div>
      <p class="online-text">Online</p>
    </div>
    <div class="location-line">
      <span class="location-name">RK's Love <span style="color:#ff0000;">Island</span>, RSA</span>
      <span class="my-time-block"><span>•</span><span>My time:</span><span id="liveTime">08:14</span><span class="ampm-suffix" id="ampmSuffix">AM</span></span>
    </div>
    <div class="property-title">
      <p>
        This is <span class="red-text">Kutlwano</span> and Reboane<span class="red-apos">'s</span> Property. Access to this <span class="red-text">space</span> grants you a glimpse into our shared <span class="red-text">moments</span> and memories.
      </p>
    </div>
  </div>

  <!-- iPod -->
  <div class="ipod">
    <div class="screen" id="screen">
      <div class="splash-screen" id="splashScreen">
        <div class="apple-png"></div>
        <div class="ipod-name">reba's ipod</div>
      </div>
      <div class="screen-content">
        <div class="status-bar">
          <span class="time" id="timeDisplay">12:00</span>
          <span class="menu-location" id="menuLocation">iPod</span>
          <div class="battery-container"><div class="battery-outline"><div class="battery-block"></div><div class="battery-block"></div><div class="battery-block"></div><div class="battery-block"></div></div></div>
        </div>

        <!-- main menu -->
        <div class="menu-container" id="menuContainer">
          <div class="menu-item active" data-title="Movies">Movies</div>
          <div class="menu-item" data-title="Diary">Diary</div>
          <div class="menu-item" data-title="Lost Files">Lost Files</div>
          <div class="menu-item" data-title="Gifts">Gifts</div>
          <div class="menu-item" data-title="Settings">Settings</div>
        </div>

        <!-- VIDEO LIST (Movies) -->
        <div class="video-list-container" id="videoListContainer" style="display:none;"></div>

        <!-- DIARY CONTAINER (message box) -->
        <div class="diary-container" id="diaryContainer" style="display:none;">
          <div class="diary-message">
            <p>Happy Valentines Day Ma,</p>
            <p>I'm grateful for the love that you show me everyday, the kindness, gentleness, and care. Of course we can't forget your jokes but you are an amazing Human Being, not only that but you sure do make a Hot girlfriend, I love you so much Lerato laka, you'll always be special to me, and I want to thank you for taking care of us the way you do.</p>
            <p class="signature">love Wano</p>
          </div>
        </div>

        <!-- Video player -->
        <div class="video-container" id="videoContainer">
          <video id="video" preload="metadata" loop playsinline></video>
        </div>

        <!-- GIFTS (model) -->
        <div class="gifts-container" id="giftsContainer" style="display:none;">
          <model-viewer src="flower.glb" auto-rotate camera-controls loading="eager" style="width:100%; height:100%; background:transparent;"></model-viewer>
        </div>

        <!-- SETTINGS -->
        <div class="settings-container" id="settingsContainer" style="display:none;">
          <div id="settingsList"></div>
        </div>
      </div>
    </div>

    <!-- click wheel -->
    <div class="wheel">
      <button class="menu-btn" id="menuBtn">MENU</button>
      <button class="next-btn" id="nextBtn"><svg viewBox="0 0 16 16"><polygon points="4,2 13,8 4,14" fill="#4a4a4a"/></svg></button>
      <button class="prev-btn" id="prevBtn"><svg viewBox="0 0 16 16"><polygon points="12,2 3,8 12,14" fill="#4a4a4a"/></svg></button>
      <button class="play-btn" id="playBtn"><svg viewBox="0 0 26 18"><polygon points="2,1 11,9 2,17" fill="#4a4a4a"/><rect x="14" y="1" width="3" height="16" fill="#4a4a4a"/><rect x="19" y="1" width="3" height="16" fill="#4a4a4a"/></svg></button>
      <button class="center-btn" id="centerBtn"></button>
    </div>
  </div>

  <script>
    (function() {
      // ---------- video list ----------
      const videoFiles = [
        "4pm in GreenSide.mp4",
        "airbnb.mp4",
        "For the groovists.mp4",
        "genZLuv.mp4",
        "nails .mp4",
        "rated 18.mp4",
        "Stole It.mp4",
        "The Day Our Lives Changed.mp4",
        "aweh.mp4"
      ];

      const videoBase = "videos/";

      // DOM elements
      const splash = document.getElementById('splashScreen');
      const menuContainer = document.getElementById('menuContainer');
      const videoListContainer = document.getElementById('videoListContainer');
      const diaryContainer = document.getElementById('diaryContainer');
      const videoContainer = document.getElementById('videoContainer');
      const video = document.getElementById('video');
      const giftsContainer = document.getElementById('giftsContainer');
      const settingsContainer = document.getElementById('settingsContainer');
      const settingsList = document.getElementById('settingsList');
      const menuLocation = document.getElementById('menuLocation');
      const timeDisplay = document.getElementById('timeDisplay');
      const liveTimeSpan = document.getElementById('liveTime');
      const ampmSpan = document.getElementById('ampmSuffix');
      const screenEl = document.getElementById('screen');
      const menuItems = document.querySelectorAll('.menu-item');
      const menuBtn = document.getElementById('menuBtn');
      const nextBtn = document.getElementById('nextBtn');
      const prevBtn = document.getElementById('prevBtn');
      const playBtn = document.getElementById('playBtn');
      const centerBtn = document.getElementById('centerBtn');

      // ---------- state ----------
      let showingSplash = true;
      let selectedIndex = 0;
      let videoListVisible = false;
      let selectedVideoIndex = 0;
      let videoPlaying = false;
      let currentVideoSrc = "";
      let giftsMode = false;
      let isSettingsMode = false;
      let selectedSettingIndex = 0;
      let diaryMode = false;        // new flag for diary

      // settings options
      let settingsOptions = [
        { key: 'backlight', label: 'Backlight', value: true },
        { key: 'blueLight', label: 'Blue Light', value: false },
        { key: 'bluetooth', label: 'Bluetooth', value: true },
        { key: 'airdrop', label: 'AirDrop', value: false },
        { key: 'sleep', label: 'Sleep', value: false }
      ];

      // Helper functions
      function renderVideoList() {
        let html = '';
        videoFiles.forEach((file, idx) => {
          const displayName = file.replace('.mp4','').replace(/_/g,' ');
          const number = (idx + 1).toString().padStart(2, '0');
          html += `<div class="menu-item ${idx === selectedVideoIndex ? 'active' : ''}" data-video-index="${idx}"><span class="video-number">${number}.</span>${displayName}</div>`;
        });
        videoListContainer.innerHTML = html;
        const activeItem = videoListContainer.querySelector('.menu-item.active');
        if (activeItem) activeItem.scrollIntoView({ block: 'nearest' });
      }

      function refreshMainMenuActive() {
        menuItems.forEach((item, idx) => {
          item.classList.toggle('active', idx === selectedIndex);
        });
        menuLocation.textContent = menuItems[selectedIndex]?.getAttribute('data-title') || 'iPod';
      }

      function renderSettings() {
        settingsList.innerHTML = settingsOptions.map((opt, i) => `
          <div class="menu-item ${i === selectedSettingIndex ? 'active' : ''}" data-index="${i}">
            ${opt.label}<span style="float:right; font-family:'IBM Plex Mono',monospace; color:#2a2a2a;">${opt.value ? 'On' : 'Off'}</span>
          </div>
        `).join('');
        const activeItem = settingsList.querySelector('.menu-item.active');
        if (activeItem) activeItem.scrollIntoView({ block: 'nearest' });
      }

      function applyBacklight() { screenEl.style.filter = settingsOptions[0].value ? 'none' : 'brightness(0.45)'; }
      function applyBlueLight() { screenEl.classList.toggle('blue-light', settingsOptions[1].value); }

      function toggleSetting(idx) {
        settingsOptions[idx].value = !settingsOptions[idx].value;
        if (settingsOptions[idx].key === 'backlight') applyBacklight();
        if (settingsOptions[idx].key === 'blueLight') applyBlueLight();
      }

      function hideSplash() {
        if (!showingSplash) return;
        showingSplash = false;
        splash.classList.add('hidden');
        menuContainer.style.display = 'block';
        videoListContainer.style.display = 'none';
        diaryContainer.style.display = 'none';
        videoContainer.style.display = 'none';
        giftsContainer.style.display = 'none';
        settingsContainer.style.display = 'none';
        videoListVisible = false;
        giftsMode = false;
        isSettingsMode = false;
        diaryMode = false;
        refreshMainMenuActive();
        menuLocation.textContent = 'iPod';
      }

      function exitToMainMenu() {
        video.pause();
        video.src = '';
        videoPlaying = false;
        videoListVisible = false;
        giftsMode = false;
        isSettingsMode = false;
        diaryMode = false;
        menuContainer.style.display = 'block';
        videoListContainer.style.display = 'none';
        diaryContainer.style.display = 'none';
        videoContainer.style.display = 'none';
        giftsContainer.style.display = 'none';
        settingsContainer.style.display = 'none';
        refreshMainMenuActive();
        menuLocation.textContent = 'iPod';
      }

      function showVideoList() {
        if (showingSplash) return;
        menuContainer.style.display = 'none';
        videoListContainer.style.display = 'block';
        diaryContainer.style.display = 'none';
        videoContainer.style.display = 'none';
        giftsContainer.style.display = 'none';
        settingsContainer.style.display = 'none';
        videoListVisible = true;
        giftsMode = false;
        isSettingsMode = false;
        diaryMode = false;
        selectedVideoIndex = 0;
        renderVideoList();
        menuLocation.textContent = 'Movies';
      }

      function showDiary() {
        if (showingSplash) return;
        menuContainer.style.display = 'none';
        videoListContainer.style.display = 'none';
        diaryContainer.style.display = 'block';
        videoContainer.style.display = 'none';
        giftsContainer.style.display = 'none';
        settingsContainer.style.display = 'none';
        diaryMode = true;
        videoListVisible = false;
        giftsMode = false;
        isSettingsMode = false;
        menuLocation.textContent = 'Diary';
      }

      function playSelectedVideo() {
        if (!videoListVisible && videoContainer.style.display !== 'block') return;
        const videoFile = videoFiles[selectedVideoIndex];
        if (!videoFile) return;
        
        video.src = videoBase + videoFile;
        video.muted = false;
        video.volume = 1.0;
        video.load();
        
        video.play().then(() => {
          videoPlaying = true;
          videoListContainer.style.display = 'none';
          diaryContainer.style.display = 'none';
          videoContainer.style.display = 'block';
          menuLocation.textContent = 'Now Playing';
        }).catch(e => {
          console.warn("play failed:", e);
          videoListContainer.style.display = 'none';
          diaryContainer.style.display = 'none';
          videoContainer.style.display = 'block';
          menuLocation.textContent = 'Now Playing';
        });
      }

      function toggleVideoPlay() {
        if (videoContainer.style.display !== 'block') return;
        if (videoPlaying) { 
          video.pause(); 
          videoPlaying = false; 
        }
        else { 
          video.play().then(() => {
            videoPlaying = true;
          }).catch(e => console.warn("play toggle failed:", e));
        }
      }

      function enterGifts() {
        if (selectedIndex !== 3) return;
        menuContainer.style.display = 'none';
        videoListContainer.style.display = 'none';
        diaryContainer.style.display = 'none';
        videoContainer.style.display = 'none';
        settingsContainer.style.display = 'none';
        giftsContainer.style.display = 'block';
        giftsMode = true;
        diaryMode = false;
        videoListVisible = false;
        isSettingsMode = false;
        menuLocation.textContent = 'Gifts';
      }

      function enterSettings() {
        if (selectedIndex !== 4) return;
        isSettingsMode = true;
        selectedSettingIndex = 0;
        menuContainer.style.display = 'none';
        videoListContainer.style.display = 'none';
        diaryContainer.style.display = 'none';
        videoContainer.style.display = 'none';
        giftsContainer.style.display = 'none';
        settingsContainer.style.display = 'block';
        renderSettings();
        menuLocation.textContent = 'Settings';
      }

      function updateClock() {
        const now = new Date();
        let hours = now.getHours();
        const minutes = now.getMinutes().toString().padStart(2,'0');
        const ampm = hours >= 12 ? 'PM' : 'AM';
        let displayHour = hours % 12 || 12;
        const timeStr = `${displayHour.toString().padStart(2,'0')}:${minutes}`;
        timeDisplay.textContent = timeStr;
        liveTimeSpan.textContent = timeStr;
        ampmSpan.textContent = ampm;
      }
      updateClock(); setInterval(updateClock, 60000);

      // ---------- Event Handlers ----------
      nextBtn.addEventListener('click', e => {
        e.stopPropagation();
        if (showingSplash) return;
        if (giftsMode) return;
        if (diaryMode) return;  // no navigation inside diary
        if (isSettingsMode) {
          selectedSettingIndex = (selectedSettingIndex + 1) % settingsOptions.length;
          renderSettings();
        }
        else if (videoListVisible) {
          selectedVideoIndex = (selectedVideoIndex + 1) % videoFiles.length;
          renderVideoList();
        }
        else if (videoContainer.style.display === 'block') {
          if (videoFiles.length > 0) {
            selectedVideoIndex = (selectedVideoIndex + 1) % videoFiles.length;
            playSelectedVideo();
          }
        }
        else {
          selectedIndex = (selectedIndex + 1) % menuItems.length;
          refreshMainMenuActive();
        }
      });

      prevBtn.addEventListener('click', e => {
        e.stopPropagation();
        if (showingSplash) return;
        if (giftsMode) return;
        if (diaryMode) return;
        if (isSettingsMode) {
          selectedSettingIndex = (selectedSettingIndex - 1 + settingsOptions.length) % settingsOptions.length;
          renderSettings();
        }
        else if (videoListVisible) {
          selectedVideoIndex = (selectedVideoIndex - 1 + videoFiles.length) % videoFiles.length;
          renderVideoList();
        }
        else if (videoContainer.style.display === 'block') {
          if (videoFiles.length > 0) {
            selectedVideoIndex = (selectedVideoIndex - 1 + videoFiles.length) % videoFiles.length;
            playSelectedVideo();
          }
        }
        else {
          selectedIndex = (selectedIndex - 1 + menuItems.length) % menuItems.length;
          refreshMainMenuActive();
        }
      });

      centerBtn.addEventListener('click', e => {
        e.stopPropagation();
        if (showingSplash) { hideSplash(); return; }
        if (giftsMode) return;
        if (diaryMode) return;   // nothing to select inside diary
        if (videoContainer.style.display === 'block') {
          toggleVideoPlay(); return;
        }
        if (isSettingsMode) {
          toggleSetting(selectedSettingIndex);
          renderSettings();
          return;
        }
        if (videoListVisible) {
          playSelectedVideo();
          return;
        }
        // main menu actions
        if (selectedIndex === 0) showVideoList();
        else if (selectedIndex === 1) showDiary();    // Diary selected
        else if (selectedIndex === 3) enterGifts();
        else if (selectedIndex === 4) enterSettings();
      });

      menuBtn.addEventListener('click', e => {
        e.stopPropagation();
        if (showingSplash) { hideSplash(); return; }
        if (videoContainer.style.display === 'block') {
          video.pause();
          videoPlaying = false;
          videoContainer.style.display = 'none';
          videoListContainer.style.display = 'block';
          menuLocation.textContent = 'Movies';
          return;
        }
        if (videoListVisible || diaryMode || giftsMode || isSettingsMode) {
          exitToMainMenu();
          return;
        }
      });

      playBtn.addEventListener('click', e => {
        e.stopPropagation();
        if (showingSplash) return;
        if (videoContainer.style.display === 'block') {
          toggleVideoPlay();
        } else if (selectedIndex === 0 && !videoListVisible) {
          showVideoList();
        } else if (videoListVisible) {
          playSelectedVideo();
        }
      });

      videoListContainer.addEventListener('click', (e) => {
        const item = e.target.closest('.menu-item');
        if (!item || !videoListVisible) return;
        const idx = item.dataset.videoIndex;
        if (idx !== undefined) {
          selectedVideoIndex = parseInt(idx, 10);
          renderVideoList();
          playSelectedVideo();
        }
      });

      settingsList.addEventListener('click', (e) => {
        if (!isSettingsMode) return;
        const item = e.target.closest('.menu-item');
        if (item) {
          const idx = parseInt(item.dataset.index, 10);
          if (!isNaN(idx)) {
            selectedSettingIndex = idx;
            toggleSetting(idx);
            renderSettings();
          }
        }
      });

      menuItems.forEach((item, idx) => {
        item.addEventListener('click', (e) => {
          e.stopPropagation();
          if (showingSplash) return;
          if (videoListVisible || giftsMode || isSettingsMode || diaryMode) return;
          selectedIndex = idx;
          refreshMainMenuActive();
          if (selectedIndex === 0) showVideoList();
          else if (selectedIndex === 1) showDiary();
          else if (selectedIndex === 3) enterGifts();
          else if (selectedIndex === 4) enterSettings();
        });
      });

      // initial state
      splash.classList.remove('hidden');
      showingSplash = true;
      menuContainer.style.display = 'block';
      videoListContainer.style.display = 'none';
      diaryContainer.style.display = 'none';
      videoContainer.style.display = 'none';
      giftsContainer.style.display = 'none';
      settingsContainer.style.display = 'none';
      refreshMainMenuActive();
      applyBacklight();
      applyBlueLight();

      // wheel scroll for containers
      const scrollContainers = [menuContainer, videoListContainer, giftsContainer, settingsContainer, diaryContainer];
      scrollContainers.forEach(container => {
        if (container) {
          container.addEventListener('wheel', (e) => {
            e.preventDefault();
            container.scrollTop += e.deltaY;
          }, { passive: false });
        }
      });

    })();
  </script>
</body>
</html>